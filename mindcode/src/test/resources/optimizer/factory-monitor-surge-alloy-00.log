   297 instructions before optimizations.
    32 instructions eliminated by DeadCodeEliminator (2 iterations).
    10 instructions eliminated by SingleStepJumpEliminator (1 iterations).
    39 instructions eliminated by OutputTempEliminator.
     2 instructions eliminated by ExpressionOptimizer.
    15 instructions eliminated by ImproveNegativeConditionalJumps.
     2 loops improved by LoopOptimizer.
     1 instructions added by LoopOptimizer.
     2 instructions eliminated by IfExpressionOptimizer.
     1 instructions eliminated by DataFlowOptimizer (2 iterations).
     1 instructions updated by PropagateJumpTargets.
     2 instructions eliminated by SingleStepJumpEliminator (1 iterations).
     1 instructions eliminated by PrintMerger.
   194 instructions after optimizations.

Modifications by DeadCodeEliminator, iteration 1:
 
    15 jump __label0 equal __tmp4 false
    16 set BAR_LENGTH 53
    17 set BAR_SPACE 74
-    * set __tmp5 BAR_SPACE
    18 jump __label1 always
    19 label __label0
    20 set BAR_LENGTH 61
    21 set BAR_SPACE 88
-    * set __tmp5 BAR_SPACE
    22 label __label1
    23 set lastRate null
    24 set icon lastRate
 
    76 draw rect 0 0 156 176
    77 set __tmp14 null
    78 label __label10
-    * set __tmp11 __tmp14
    79 jump __label8 always
    80 label __label7
-    * set __tmp11 null
    81 label __label8
    82 print "\nNominal production: "
    83 print EXPECTED_FLOW_STR
 
    85 print "\nActual production: "
    86 print flow_str
    87 print "/min"
-    * set __tmp9 null
    88 jump __label6 always
    89 label __label5
-    * set __tmp9 null
    90 label __label6
    91 set __tmp25 @time
    92 set start __tmp25
 
   123 jump __label16 equal __tmp40 false
   124 set minimum l
   125 set icon @lead
-    * set __tmp41 icon
   126 jump __label17 always
   127 label __label16
-    * set __tmp41 null
   128 label __label17
   129 op lessThan __tmp42 s minimum
   130 jump __label18 equal __tmp42 false
   131 set minimum s
   132 set icon @silicon
-    * set __tmp43 icon
   133 jump __label19 always
   134 label __label18
-    * set __tmp43 null
   135 label __label19
   136 op lessThan __tmp44 c minimum
   137 jump __label20 equal __tmp44 false
   138 set minimum c
   139 set icon @copper
-    * set __tmp45 icon
   140 jump __label21 always
   141 label __label20
-    * set __tmp45 null
   142 label __label21
   143 op lessThan __tmp46 t minimum
   144 jump __label22 equal __tmp46 false
   145 set minimum t
   146 set icon @titanium
-    * set __tmp47 icon
   147 jump __label23 always
   148 label __label22
-    * set __tmp47 null
   149 label __label23
   150 op greaterThan __tmp48 a 5
   151 op sub __tmp49 21 a
 
   154 set showa __tmp51
   155 jump __label24 equal showa false
   156 set icon @surge-alloy
-    * set __tmp52 icon
   157 jump __label25 always
   158 label __label24
-    * set __tmp52 null
   159 label __label25
   160 op mod __tmp53 index 2
   161 set column __tmp53
 
   178 op land __tmp63 __tmp61 __tmp62
   179 jump __label26 equal __tmp63 false
   180 set icon @surge-smelter
-    * set __tmp64 icon
   181 jump __label27 always
   182 label __label26
-    * set __tmp64 null
   183 label __label27
   184 draw color 255 255 255 255
   185 jump __label28 equal e false
 
   210 draw rect __tmp75 __tmp76 2 2
   211 set __tmp67 null
   212 label __label31
-    * set __tmp65 __tmp67
   213 jump __label29 always
   214 label __label28
   215 op add __tmp77 x 2
 
   227 draw color 0 0 0 255
   228 draw lineRect xm1 ym1 16 16
   229 draw stroke 2
-    * set __tmp65 null
   230 label __label29
   231 op add __tmp81 x 16
   232 set x __tmp81
 
   236 set red 255
   237 set green 0
   238 set blue 0
-    * set __tmp84 blue
   239 jump __label33 always
   240 label __label32
   241 jump __label34 equal showa false
 
   267 set blue 0
   268 set __tmp85 blue
   269 label __label35
-    * set __tmp84 __tmp85
   270 label __label33
   271 op greaterThan __tmp92 boost EXPECTED_BOOST
   272 jump __label40 equal __tmp92 false
 
   277 op max __tmp96 192 blue
   278 set blue __tmp96
   279 set boost EXPECTED_BOOST
-    * set __tmp93 boost
   280 jump __label41 always
   281 label __label40
-    * set __tmp93 null
   282 label __label41
   283 op mul __tmp97 BAR_LENGTH boost
   284 op idiv __tmp98 __tmp97 EXPECTED_BOOST
 
   291 draw lineRect x y length BAR_WIDTH
   292 op add __tmp101 index 1
   293 set index __tmp101
-    * set __tmp30 index
   294 jump __label15 always
   295 label __label14
-    * set __tmp30 null
   296 label __label15
   297 label __label12
   298 op add __tmp102 n 1

Modifications by DeadCodeEliminator, iteration 2:
 
    69 op mul __tmp23 3600 rate
    70 op floor __tmp24 __tmp23
    71 set flow_str __tmp24
-    * set __tmp14 flow_str
    72 jump __label10 always
    73 label __label9
    74 draw color 0 0 80 255
    75 draw rect 0 0 156 176
-    * set __tmp14 null
    76 label __label10
    77 jump __label8 always
    78 label __label7
 
   186 op add __tmp68 x 7
   187 op add __tmp69 y 7
   188 draw image __tmp68 __tmp69 icon 16 0
-    * set __tmp67 null
   189 jump __label31 always
   190 label __label30
   191 op add __tmp70 x 12
 
   205 op add __tmp75 x 4
   206 op add __tmp76 y 6
   207 draw rect __tmp75 __tmp76 2 2
-    * set __tmp67 null
   208 label __label31
   209 jump __label29 always
   210 label __label28
 
   239 set green 0
   240 set blue 255
   241 set minimum a
-    * set __tmp85 minimum
   242 jump __label35 always
   243 label __label34
   244 op greaterThan __tmp86 minimum 14
 
   260 label __label39
   261 set green __tmp91
   262 set blue 0
-    * set __tmp85 blue
   263 label __label35
   264 label __label33
   265 op greaterThan __tmp92 boost EXPECTED_BOOST

Modifications by SingleStepJumpEliminator, iteration 1:
 
    74 draw color 0 0 80 255
    75 draw rect 0 0 156 176
    76 label __label10
-    * jump __label8 always
    77 label __label7
    78 label __label8
    79 print "\nNominal production: "
 
    82 print "\nActual production: "
    83 print flow_str
    84 print "/min"
-    * jump __label6 always
    85 label __label5
    86 label __label6
    87 set __tmp25 @time
 
   119 jump __label16 equal __tmp40 false
   120 set minimum l
   121 set icon @lead
-    * jump __label17 always
   122 label __label16
   123 label __label17
   124 op lessThan __tmp42 s minimum
   125 jump __label18 equal __tmp42 false
   126 set minimum s
   127 set icon @silicon
-    * jump __label19 always
   128 label __label18
   129 label __label19
   130 op lessThan __tmp44 c minimum
   131 jump __label20 equal __tmp44 false
   132 set minimum c
   133 set icon @copper
-    * jump __label21 always
   134 label __label20
   135 label __label21
   136 op lessThan __tmp46 t minimum
   137 jump __label22 equal __tmp46 false
   138 set minimum t
   139 set icon @titanium
-    * jump __label23 always
   140 label __label22
   141 label __label23
   142 op greaterThan __tmp48 a 5
 
   146 set showa __tmp51
   147 jump __label24 equal showa false
   148 set icon @surge-alloy
-    * jump __label25 always
   149 label __label24
   150 label __label25
   151 op mod __tmp53 index 2
 
   169 op land __tmp63 __tmp61 __tmp62
   170 jump __label26 equal __tmp63 false
   171 set icon @surge-smelter
-    * jump __label27 always
   172 label __label26
   173 label __label27
   174 draw color 255 255 255 255
 
   263 op max __tmp96 192 blue
   264 set blue __tmp96
   265 set boost EXPECTED_BOOST
-    * jump __label41 always
   266 label __label40
   267 label __label41
   268 op mul __tmp97 BAR_LENGTH boost
 
   276 draw lineRect x y length BAR_WIDTH
   277 op add __tmp101 index 1
   278 set index __tmp101
-    * jump __label15 always
   279 label __label14
   280 label __label15
   281 label __label12

Modifications by OutputTempEliminator, iteration 1:
 
     5 set BAR_GAP 22
     6 set CAPACITY 20
     7 op mul __tmp0 EXPECTED_BOOST 16
-    * op div __tmp1 __tmp0 75
-    * set EXPECTED_FLOW __tmp1
+    8 op div EXPECTED_FLOW __tmp0 75
     9 op mul __tmp2 EXPECTED_FLOW 3600
-    * op floor __tmp3 __tmp2
-    * set EXPECTED_FLOW_STR __tmp3
+   10 op floor EXPECTED_FLOW_STR __tmp2
    11 set RATE_INDEX 511
    12 op notEqual __tmp4 bank1 null
    13 jump __label0 equal __tmp4 false
 
    31 jump __label5 equal __tmp8 false
    32 op equal __tmp10 FROM_INDEX 0
    33 jump __label7 equal __tmp10 false
-    * read __tmp12 bank1 RATE_INDEX
-    * set rate __tmp12
+   34 read rate bank1 RATE_INDEX
    35 op notEqual __tmp13 lastRate rate
    36 jump __label9 equal __tmp13 false
    37 draw clear 0 0 80
 
    52 op sub __tmp15 rate EXPECTED_FLOW
    53 op mul __tmp16 84 __tmp15
    54 op div __tmp17 __tmp16 EXPECTED_FLOW
-    * op add __tmp18 88 __tmp17
-    * set pos __tmp18
+   55 op add pos 88 __tmp17
    56 op max __tmp19 pos 4
-    * op min __tmp20 __tmp19 170
-    * set pos __tmp20
-    * op add __tmp21 pos 7
-    * set pos1 __tmp21
-    * op sub __tmp22 pos 7
-    * set pos2 __tmp22
+   57 op min pos __tmp19 170
+   58 op add pos1 pos 7
+   59 op sub pos2 pos 7
    60 draw color 255 255 16 255
    61 draw triangle 156 pos1 164 pos 156 pos2
    62 op mul __tmp23 3600 rate
-    * op floor __tmp24 __tmp23
-    * set flow_str __tmp24
+   63 op floor flow_str __tmp23
    64 jump __label10 always
    65 label __label9
    66 draw color 0 0 80 255
 
    76 print "/min"
    77 label __label5
    78 label __label6
-    * set __tmp25 @time
-    * set start __tmp25
+   79 set start @time
    80 draw stroke 2
    81 set index FROM_INDEX
    82 set n 0
    83 label __label11
    84 op lessThan __tmp26 n @links
    85 jump __label13 equal __tmp26 false
-    * getlink __tmp27 n
-    * set smelter __tmp27
+   86 getlink smelter n
    87 sensor __tmp28 smelter @type
    88 op equal __tmp29 __tmp28 @surge-smelter
    89 jump __label14 equal __tmp29 false
-    * op add __tmp31 CAPACITY 1
-    * set minimum __tmp31
-    * sensor __tmp32 smelter @titanium
-    * set t __tmp32
-    * sensor __tmp33 smelter @copper
-    * set c __tmp33
-    * sensor __tmp34 smelter @lead
-    * set l __tmp34
-    * sensor __tmp35 smelter @silicon
-    * set s __tmp35
-    * sensor __tmp36 smelter @surge-alloy
-    * set a __tmp36
-    * sensor __tmp37 smelter @enabled
-    * set e __tmp37
-    * sensor __tmp38 smelter @totalPower
-    * set power __tmp38
-    * sensor __tmp39 smelter @timescale
-    * set boost __tmp39
+   90 op add minimum CAPACITY 1
+   91 sensor t smelter @titanium
+   92 sensor c smelter @copper
+   93 sensor l smelter @lead
+   94 sensor s smelter @silicon
+   95 sensor a smelter @surge-alloy
+   96 sensor e smelter @enabled
+   97 sensor power smelter @totalPower
+   98 sensor boost smelter @timescale
    99 op lessThan __tmp40 l minimum
   100 jump __label16 equal __tmp40 false
   101 set minimum l
 
   123 op greaterThan __tmp48 a 5
   124 op sub __tmp49 21 a
   125 op lessThan __tmp50 __tmp49 minimum
-    * op land __tmp51 __tmp48 __tmp50
-    * set showa __tmp51
+  126 op land showa __tmp48 __tmp50
   127 jump __label24 equal showa false
   128 set icon @surge-alloy
   129 label __label24
   130 label __label25
-    * op mod __tmp53 index 2
-    * set column __tmp53
-    * op idiv __tmp54 index 2
-    * set row __tmp54
+  131 op mod column index 2
+  132 op idiv row index 2
   133 op mul __tmp55 column BAR_SPACE
-    * op add __tmp56 OFFSET_X __tmp55
-    * set x __tmp56
+  134 op add x OFFSET_X __tmp55
   135 op mul __tmp57 row BAR_GAP
-    * op add __tmp58 OFFSET_Y __tmp57
-    * set y __tmp58
-    * op sub __tmp59 x 1
-    * set xm1 __tmp59
-    * op sub __tmp60 y 1
-    * set ym1 __tmp60
+  136 op add y OFFSET_Y __tmp57
+  137 op sub xm1 x 1
+  138 op sub ym1 y 1
   139 draw color 0 0 80 255
   140 draw rect xm1 ym1 BAR_SPACE 16
   141 op greaterThan __tmp61 minimum 16
 
   154 draw image __tmp68 __tmp69 icon 16 0
   155 jump __label31 always
   156 label __label30
-    * op add __tmp70 x 12
-    * set x12 __tmp70
-    * op add __tmp71 y 3
-    * set y3 __tmp71
+  157 op add x12 x 12
+  158 op add y3 y 3
   159 draw color 255 80 80 255
   160 draw rect x y3 14 8
   161 draw color 0 0 0 255
 
   172 label __label31
   173 jump __label29 always
   174 label __label28
-    * op add __tmp77 x 2
-    * set x2 __tmp77
-    * op add __tmp78 y 2
-    * set y2 __tmp78
-    * op add __tmp79 x 12
-    * set x12 __tmp79
-    * op add __tmp80 y 12
-    * set y12 __tmp80
+  175 op add x2 x 2
+  176 op add y2 y 2
+  177 op add x12 x 12
+  178 op add y12 y 12
   179 draw color 255 80 80 255
   180 draw stroke 3
   181 draw line x2 y12 x12 y2
 
   184 draw lineRect xm1 ym1 16 16
   185 draw stroke 2
   186 label __label29
-    * op add __tmp81 x 16
-    * set x __tmp81
+  187 op add x x 16
   188 op mul __tmp82 power e
   189 op equal __tmp83 __tmp82 0
   190 jump __label32 equal __tmp83 false
 
   223 label __label33
   224 op greaterThan __tmp92 boost EXPECTED_BOOST
   225 jump __label40 equal __tmp92 false
-    * op max __tmp94 192 red
-    * set red __tmp94
-    * op max __tmp95 192 green
-    * set green __tmp95
-    * op max __tmp96 192 blue
-    * set blue __tmp96
+  226 op max red 192 red
+  227 op max green 192 green
+  228 op max blue 192 blue
   229 set boost EXPECTED_BOOST
   230 label __label40
   231 label __label41
   232 op mul __tmp97 BAR_LENGTH boost
-    * op idiv __tmp98 __tmp97 EXPECTED_BOOST
-    * set length __tmp98
+  233 op idiv length __tmp97 EXPECTED_BOOST
   234 draw color red green blue 128
   235 op mul __tmp99 minimum length
   236 op idiv __tmp100 __tmp99 CAPACITY
   237 draw rect x y __tmp100 BAR_WIDTH
   238 draw color red green blue 255
   239 draw lineRect x y length BAR_WIDTH
-    * op add __tmp101 index 1
-    * set index __tmp101
+  240 op add index index 1
   241 label __label14
   242 label __label15
   243 label __label12
-    * op add __tmp102 n 1
-    * set n __tmp102
+  244 op add n n 1
   245 jump __label11 always
   246 label __label13
   247 drawflush display1

Modifications by ExpressionOptimizer, iteration 1:
 
     6 set CAPACITY 20
     7 op mul __tmp0 EXPECTED_BOOST 16
     8 op div EXPECTED_FLOW __tmp0 75
-    * op mul __tmp2 EXPECTED_FLOW 3600
-    * op floor EXPECTED_FLOW_STR __tmp2
+    9 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
    10 set RATE_INDEX 511
    11 op notEqual __tmp4 bank1 null
    12 jump __label0 equal __tmp4 false
 
    58 op sub pos2 pos 7
    59 draw color 255 255 16 255
    60 draw triangle 156 pos1 164 pos 156 pos2
-    * op mul __tmp23 3600 rate
-    * op floor flow_str __tmp23
+   61 op idiv flow_str rate 0.0002777777777777778
    62 jump __label10 always
    63 label __label9
    64 draw color 0 0 80 255

Modifications by ImproveNegativeConditionalJumps, iteration 1:
 
     8 op div EXPECTED_FLOW __tmp0 75
     9 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
    10 set RATE_INDEX 511
-    * op notEqual __tmp4 bank1 null
-    * jump __label0 equal __tmp4 false
+   11 jump __label0 equal bank1 null
    12 set BAR_LENGTH 53
    13 set BAR_SPACE 74
    14 jump __label1 always
 
    22 control enabled switch1 0
    23 label __label2
    24 sensor __tmp6 switch1 @enabled
-    * op equal __tmp7 __tmp6 0
-    * jump __label4 equal __tmp7 false
+   25 jump __label4 notEqual __tmp6 0
    26 print "Surge Alloy Factory Monitor"
-    * op notEqual __tmp8 bank1 null
-    * jump __label5 equal __tmp8 false
-    * op equal __tmp10 FROM_INDEX 0
-    * jump __label7 equal __tmp10 false
+   27 jump __label5 equal bank1 null
+   28 jump __label7 notEqual FROM_INDEX 0
    29 read rate bank1 RATE_INDEX
-    * op notEqual __tmp13 lastRate rate
-    * jump __label9 equal __tmp13 false
+   30 jump __label9 equal lastRate rate
    31 draw clear 0 0 80
    32 set lastRate rate
    33 draw color 0 0 80 255
 
    74 set index FROM_INDEX
    75 set n 0
    76 label __label11
-    * op lessThan __tmp26 n @links
-    * jump __label13 equal __tmp26 false
+   77 jump __label13 greaterThanEq n @links
    78 getlink smelter n
    79 sensor __tmp28 smelter @type
-    * op equal __tmp29 __tmp28 @surge-smelter
-    * jump __label14 equal __tmp29 false
+   80 jump __label14 notEqual __tmp28 @surge-smelter
    81 op add minimum CAPACITY 1
    82 sensor t smelter @titanium
    83 sensor c smelter @copper
 
    87 sensor e smelter @enabled
    88 sensor power smelter @totalPower
    89 sensor boost smelter @timescale
-    * op lessThan __tmp40 l minimum
-    * jump __label16 equal __tmp40 false
+   90 jump __label16 greaterThanEq l minimum
    91 set minimum l
    92 set icon @lead
    93 label __label16
    94 label __label17
-    * op lessThan __tmp42 s minimum
-    * jump __label18 equal __tmp42 false
+   95 jump __label18 greaterThanEq s minimum
    96 set minimum s
    97 set icon @silicon
    98 label __label18
    99 label __label19
-    * op lessThan __tmp44 c minimum
-    * jump __label20 equal __tmp44 false
+  100 jump __label20 greaterThanEq c minimum
   101 set minimum c
   102 set icon @copper
   103 label __label20
   104 label __label21
-    * op lessThan __tmp46 t minimum
-    * jump __label22 equal __tmp46 false
+  105 jump __label22 greaterThanEq t minimum
   106 set minimum t
   107 set icon @titanium
   108 label __label22
 
   134 label __label27
   135 draw color 255 255 255 255
   136 jump __label28 equal e false
-    * op greaterThan __tmp66 power 0
-    * jump __label30 equal __tmp66 false
+  137 jump __label30 lessThanEq power 0
   138 op add __tmp68 x 7
   139 op add __tmp69 y 7
   140 draw image __tmp68 __tmp69 icon 16 0
 
   172 label __label29
   173 op add x x 16
   174 op mul __tmp82 power e
-    * op equal __tmp83 __tmp82 0
-    * jump __label32 equal __tmp83 false
+  175 jump __label32 notEqual __tmp82 0
   176 set red 255
   177 set green 0
   178 set blue 0
 
   195 set __tmp89 255
   196 label __label37
   197 set red __tmp89
-    * op greaterThan __tmp90 minimum 7
-    * jump __label38 equal __tmp90 false
+  198 jump __label38 lessThanEq minimum 7
   199 set __tmp91 255
   200 jump __label39 always
   201 label __label38
 
   205 set blue 0
   206 label __label35
   207 label __label33
-    * op greaterThan __tmp92 boost EXPECTED_BOOST
-    * jump __label40 equal __tmp92 false
+  208 jump __label40 lessThanEq boost EXPECTED_BOOST
   209 op max red 192 red
   210 op max green 192 green
   211 op max blue 192 blue

Modifications by LoopOptimizer, iteration 1:
 
    23 label __label2
    24 sensor __tmp6 switch1 @enabled
    25 jump __label4 notEqual __tmp6 0
+   26 label __label42
    27 print "Surge Alloy Factory Monitor"
    28 jump __label5 equal bank1 null
    29 jump __label7 notEqual FROM_INDEX 0
 
    76 set n 0
    77 label __label11
    78 jump __label13 greaterThanEq n @links
+   79 label __label43
    80 getlink smelter n
    81 sensor __tmp28 smelter @type
    82 jump __label14 notEqual __tmp28 @surge-smelter
 
   227 label __label15
   228 label __label12
   229 op add n n 1
-    * jump __label11 always
+  230 jump __label43 lessThan n @links
   231 label __label13
   232 drawflush display1
   233 op sub __tmp103 @time start
 
   237 print " ms"
   238 printflush message1
   239 label __label3
-    * jump __label2 always
+  240 sensor __tmp6 switch1 @enabled
+  241 jump __label42 equal __tmp6 0
   242 label __label4
   243 end

Modifications by IfExpressionOptimizer, iteration 1:
 
   187 set minimum a
   188 jump __label35 always
   189 label __label34
+  190 set red 255
   191 op greaterThan __tmp86 minimum 14
   192 op greaterThanEq __tmp87 boost EXPECTED_BOOST
   193 op land __tmp88 __tmp86 __tmp87
-    * jump __label36 equal __tmp88 false
-    * set __tmp89 0
+  194 jump __label37 equal __tmp88 false
+  195 set red 0
   196 jump __label37 always
-    * label __label36
-    * set __tmp89 255
   197 label __label37
-    * set red __tmp89
-    * jump __label38 lessThanEq minimum 7
-    * set __tmp91 255
+  198 set green 0
+  199 jump __label39 lessThanEq minimum 7
+  200 set green 255
   201 jump __label39 always
-    * label __label38
-    * set __tmp91 0
   202 label __label39
-    * set green __tmp91
   203 set blue 0
   204 label __label35
   205 label __label33

Modifications by DataFlowOptimizer, iteration 1:
 
     5 set BAR_GAP 22
     6 set CAPACITY 20
     7 op mul __tmp0 EXPECTED_BOOST 16
-    * op div EXPECTED_FLOW __tmp0 75
+    8 op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
     9 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
    10 set RATE_INDEX 511
    11 jump __label0 equal bank1 null
 
    17 set BAR_SPACE 88
    18 label __label1
    19 set lastRate null
-    * set icon lastRate
-    * set flow_str icon
+   20 set icon null
+   21 set flow_str lastRate
    22 control enabled switch1 0
    23 label __label2
    24 sensor __tmp6 switch1 @enabled
 
    75 set index FROM_INDEX
    76 set n 0
    77 label __label11
-    * jump __label13 greaterThanEq n @links
+   78 jump __label13 greaterThanEq 0 @links
    79 label __label43
    80 getlink smelter n
    81 sensor __tmp28 smelter @type

Modifications by DataFlowOptimizer, iteration 2:
 
     4 set BAR_WIDTH 14
     5 set BAR_GAP 22
     6 set CAPACITY 20
-    * op mul __tmp0 EXPECTED_BOOST 16
     7 op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
     8 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
     9 set RATE_INDEX 511
 
    17 label __label1
    18 set lastRate null
    19 set icon null
-    * set flow_str lastRate
+   20 set flow_str null
    21 control enabled switch1 0
    22 label __label2
    23 sensor __tmp6 switch1 @enabled

Modifications by PropagateJumpTargets, iteration 1:
 
   139 op add __tmp68 x 7
   140 op add __tmp69 y 7
   141 draw image __tmp68 __tmp69 icon 16 0
-    * jump __label31 always
+  142 jump __label29 always
   143 label __label30
   144 op add x12 x 12
   145 op add y3 y 3

Modifications by SingleStepJumpEliminator, iteration 1:
 
   192 op land __tmp88 __tmp86 __tmp87
   193 jump __label37 equal __tmp88 false
   194 set red 0
-    * jump __label37 always
   195 label __label37
   196 set green 0
   197 jump __label39 lessThanEq minimum 7
   198 set green 255
-    * jump __label39 always
   199 label __label39
   200 set blue 0
   201 label __label35

Modifications by PrintMerger, iteration 1:
 
    63 label __label8
    64 print "\nNominal production: "
    65 print EXPECTED_FLOW_STR
-    * print "/min"
-    * print "\nActual production: "
+   66 print "/min\nActual production: "
    67 print flow_str
    68 print "/min"
    69 label __label5

Final code before resolving virtual instructions:

set FROM_INDEX 0
set EXPECTED_BOOST 1.5
set OFFSET_X 5
set OFFSET_Y 4
set BAR_WIDTH 14
set BAR_GAP 22
set CAPACITY 20
op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
set RATE_INDEX 511
jump __label0 equal bank1 null
set BAR_LENGTH 53
set BAR_SPACE 74
jump __label1 always 0 0
label __label0
set BAR_LENGTH 61
set BAR_SPACE 88
label __label1
set lastRate null
set icon null
set flow_str null
control enabled switch1 0 0 0 0
label __label2
sensor __tmp6 switch1 @enabled
jump __label4 notEqual __tmp6 0
label __label42
print "Surge Alloy Factory Monitor"
jump __label5 equal bank1 null
jump __label7 notEqual FROM_INDEX 0
read rate bank1 RATE_INDEX
jump __label9 equal lastRate rate
draw clear 0 0 80 0 0 0
set lastRate rate
draw color 0 0 80 255 0 0
draw rect 156 0 16 176 0 0
draw color 255 128 128 255 0 0
draw rect 164 4 8 84 0 0
draw color 128 255 128 255 0 0
draw rect 164 89 8 84 0 0
draw stroke 1 0 0 0 0 0
draw color 255 0 0 255 0 0
draw lineRect 164 4 8 84 0 0
draw color 0 255 0 255 0 0
draw lineRect 164 89 8 84 0 0
draw color 0 0 80 255 0 0
draw rect 164 4 2 170 0 0
op sub __tmp15 rate EXPECTED_FLOW
op mul __tmp16 84 __tmp15
op div __tmp17 __tmp16 EXPECTED_FLOW
op add pos 88 __tmp17
op max __tmp19 pos 4
op min pos __tmp19 170
op add pos1 pos 7
op sub pos2 pos 7
draw color 255 255 16 255 0 0
draw triangle 156 pos1 164 pos 156 pos2
op idiv flow_str rate 0.0002777777777777778
jump __label10 always 0 0
label __label9
draw color 0 0 80 255 0 0
draw rect 0 0 156 176 0 0
label __label10
label __label7
label __label8
print "\nNominal production: "
print EXPECTED_FLOW_STR
print "/min\nActual production: "
print flow_str
print "/min"
label __label5
label __label6
set start @time
draw stroke 2 0 0 0 0 0
set index FROM_INDEX
set n 0
label __label11
jump __label13 greaterThanEq 0 @links
label __label43
getlink smelter n
sensor __tmp28 smelter @type
jump __label14 notEqual __tmp28 @surge-smelter
op add minimum CAPACITY 1
sensor t smelter @titanium
sensor c smelter @copper
sensor l smelter @lead
sensor s smelter @silicon
sensor a smelter @surge-alloy
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label16 greaterThanEq l minimum
set minimum l
set icon @lead
label __label16
label __label17
jump __label18 greaterThanEq s minimum
set minimum s
set icon @silicon
label __label18
label __label19
jump __label20 greaterThanEq c minimum
set minimum c
set icon @copper
label __label20
label __label21
jump __label22 greaterThanEq t minimum
set minimum t
set icon @titanium
label __label22
label __label23
op greaterThan __tmp48 a 5
op sub __tmp49 21 a
op lessThan __tmp50 __tmp49 minimum
op land showa __tmp48 __tmp50
jump __label24 equal showa false
set icon @surge-alloy
label __label24
label __label25
op mod column index 2
op idiv row index 2
op mul __tmp55 column BAR_SPACE
op add x OFFSET_X __tmp55
op mul __tmp57 row BAR_GAP
op add y OFFSET_Y __tmp57
op sub xm1 x 1
op sub ym1 y 1
draw color 0 0 80 255 0 0
draw rect xm1 ym1 BAR_SPACE 16 0 0
op greaterThan __tmp61 minimum 16
op equal __tmp62 showa 0
op land __tmp63 __tmp61 __tmp62
jump __label26 equal __tmp63 false
set icon @surge-smelter
label __label26
label __label27
draw color 255 255 255 255 0 0
jump __label28 equal e false
jump __label30 lessThanEq power 0
op add __tmp68 x 7
op add __tmp69 y 7
draw image __tmp68 __tmp69 icon 16 0 0
jump __label29 always 0 0
label __label30
op add x12 x 12
op add y3 y 3
draw color 255 80 80 255 0 0
draw rect x y3 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp72 x 2
op add __tmp73 y 5
draw rect __tmp72 __tmp73 8 4 0 0
draw rect x12 y3 2 2 0 0
op add __tmp74 y 9
draw rect x12 __tmp74 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp75 x 4
op add __tmp76 y 6
draw rect __tmp75 __tmp76 2 2 0 0
label __label31
jump __label29 always 0 0
label __label28
op add x2 x 2
op add y2 y 2
op add x12 x 12
op add y12 y 12
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
draw line x2 y12 x12 y2 0 0
draw line x2 y2 x12 y12 0 0
draw color 0 0 0 255 0 0
draw lineRect xm1 ym1 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label29
op add x x 16
op mul __tmp82 power e
jump __label32 notEqual __tmp82 0
set red 255
set green 0
set blue 0
jump __label33 always 0 0
label __label32
jump __label34 equal showa false
set red 255
set green 0
set blue 255
set minimum a
jump __label35 always 0 0
label __label34
set red 255
op greaterThan __tmp86 minimum 14
op greaterThanEq __tmp87 boost EXPECTED_BOOST
op land __tmp88 __tmp86 __tmp87
jump __label37 equal __tmp88 false
set red 0
label __label37
set green 0
jump __label39 lessThanEq minimum 7
set green 255
label __label39
set blue 0
label __label35
label __label33
jump __label40 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 blue
set boost EXPECTED_BOOST
label __label40
label __label41
op mul __tmp97 BAR_LENGTH boost
op idiv length __tmp97 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp99 minimum length
op idiv __tmp100 __tmp99 CAPACITY
draw rect x y __tmp100 BAR_WIDTH 0 0
draw color red green blue 255 0 0
draw lineRect x y length BAR_WIDTH 0 0
op add index index 1
label __label14
label __label15
label __label12
op add n n 1
jump __label43 lessThan n @links
label __label13
drawflush display1
op sub __tmp103 @time start
op floor __tmp104 __tmp103 0
print "\nUpdate time: "
print __tmp104
print " ms"
printflush message1
label __label3
sensor __tmp6 switch1 @enabled
jump __label42 equal __tmp6 0
label __label4
end
